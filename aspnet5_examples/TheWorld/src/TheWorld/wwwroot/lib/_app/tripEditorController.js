!function(){"use strict";function o(o,t){var r=this;r.tripName=o.tripName,r.newStop={},r.stops=[],r.errorMessage="",r.isBusy=!0,r.tableHeaders=[{name:"Location",field:"name"},{name:"Arrival",field:"arrival"}],r.sort={by:"",column:{}},r.sort.exec=function(o){var e=function(o,e){r.sort.by=e?o.field:"-"+o.field,r.sort.column={header:o,order:e}};null==r.sort.column.header||r.sort.column.header.field!=o.field?e(o,!0):e(o,!r.sort.column.order)},r.sort.exec(r.tableHeaders[0]),r.addStop=function(){r.isBusy=!0,r.errorMessage="",t.addStop(r.tripName,r.newStop).then(function(o){r.stops.push(o),e(r.stops),r.newStop={}},function(o){r.errorMessage="Failed to add new stop. "+o})["finally"](function(){r.isBusy=!1})},t.getTripStops(r.tripName).then(function(o){angular.copy(o,r.stops),e(r.stops)},function(o){r.errorMessage="Failed to load data: "+o})["finally"](function(){r.isBusy=!1})}function e(o){if(o&&o.length>0){var e=_.map(o,function(o){return{lat:o.latitude,"long":o.longitude,info:o.name}});travelMap.createMap({stops:e,selector:"#map",currentStop:0,initialZoom:5,icon:{url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAGCAIAAABvrngfAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjExR/NCNwAAAA1JREFUGFdjoDNgYAAAAHIAAejt7scAAAAASUVORK5CYII=",width:3,height:3},pastStroke:{color:"#190300",opacity:.5,weight:2},futureStroke:{color:"#D30000",opacity:.6,weight:2},mapOptions:{draggable:!0,scrollwheel:!0,disableDoubleClickZoom:!0,zoomControl:!0}})}}var t=angular.module("app-trips");t.controller("tripEditorController",["$routeParams","repo",o])}();